@{
  Layout = "_BlankLayout";
  ViewData["Title"] = "Login";
}

@section VendorStyles {
  <link rel="stylesheet" href="~/vendor/libs/&#64;form-validation/form-validation.css" />
}

@section VendorScripts {
  <script src="~/vendor/libs/&#64;form-validation/popular.js"></script>
  <script src="~/vendor/libs/&#64;form-validation/bootstrap5.js"></script>
  <script src="~/vendor/libs/&#64;form-validation/auto-focus.js"></script>
}

@section PageStyles {
  <link rel="stylesheet" href="~/vendor/css/pages/page-auth.css">
}

@section PageScripts {
  <script src="~/js/pages-auth.js"></script>
}


@{
  string login_error_msg = ViewData["login_error_msg"] is string login_error_msg_value ?
  login_error_msg_value : "";
}

@model Boolean

@* ************** Content ************** *@
<div class="authentication-wrapper authentication-cover">

  @* Script para hacer la validacion de campos del login *@
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', () => {

      //Metodo para validar campos
      const check_login_inputs = (event) => {
        //Definicion de variables que contienen la referencia a su respectivo elemento html
        const username = document.getElementById("username");
        const password = document.getElementById("password");

        //Validacion de campos no nulos o vacios
        if (!username.value || !password.value) {
          //Mostrar y personalizar mensaje de error
          document.getElementById('error_message').style.display = 'block';
          document.getElementById('error_message').innerHTML = 'Por favor completar todos los campos.';
        } else {
          //Ocultar posibles mensajes de error
          document.getElementById('error_message').style.display = 'none';

          document.getElementById('error_message').style.display = 'none';
          document.getElementById('loginForm').submit();


        }
      }

      //Metodo para Mostrar y Ocultar password
      passwordField = document.getElementById("password");
      passwordIcon = document.getElementById("togglePasswordIcon");
      passwordToggle = document.getElementById("togglePassword");

      passwordToggle.addEventListener("click", () => {
        if (passwordField.type === "password") {
          passwordField.type = "text";
          passwordIcon.classList = "ti ti-eye";
        } else {
          passwordField.type = "password";
          passwordIcon.classList = "ti ti-eye-off";

        }
      });



      //Asignacion del metodo check_inputs_add_employee al boton correspondiente
      document.getElementById("loginButton").addEventListener('click', check_login_inputs);

    });
  </script>

  <!-- MAIN DIV -->
  <div class="authentication-inner row m-0 justify-content-center mt-12">

    <!-- Div del Login -->
    <div class="d-flex col-12 col-lg-4 align-items-center authentication-bg p-sm-12 p-6"
      style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); background-color: white;">
      <div class="w-px-400 mx-auto mt-12 pt-5">

        @* Titulo de bienvendia *@
        <h4 class="mb-1">Bienvendio a Service Track ID! 游녦</h4>
        <p class="mb-6">Por favor ingrese con su usuario y contrase침a</p>

        @* Form del login *@
        <form id="loginForm" asp-action="Login" asp-controller="Auth" class="mb-6" method="POST">

          @* Div del username *@
          <div class="mb-6">
            <label for="username" class="form-label">Usuario</label>
            <input type="username" class="form-control" id="username" name="username" placeholder="Ingrese su Usuario"
              autofocus>
          </div>
          @* Div de la contrase침a *@
          <div class="mb-6 form-password-toggle">
            <label class="form-label" for="password">Contrase침a</label>
            <div class="input-group input-group-merge">

              <input type="password" id="password" class="form-control" name="password"
                placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                aria-describedby="password" />
              <span class="input-group-text cursor-pointer" id="togglePassword"><i id="togglePasswordIcon"
                  class="ti ti-eye-off"></i></span>

            </div>
          </div>
          @* Mensaje de error en caso de que las credenciales enviadas sean invalidas *@
          @if (login_error_msg != "")
          {
            <div class="alert alert-danger" id="login_error_msg_div">
              <p class="text-danger text-center">@(login_error_msg)</p>
            </div>
          }

          @* Mensaje en caso de error al completar el formulario *@
          <div class="mb-6 form-password-toggle">
            <p class="text-danger text-center" id="error_message" style="display: none;">Error</p>
          </div>

          @* Checkbox de recordarme y olvidar password *@
          <div class="my-8">
            <div class="d-flex justify-content-between">
              <div class="form-check mb-0 ms-2">
                <input class="form-check-input" type="checkbox" id="remember-me">
                <label class="form-check-label" for="remember-me">
                  Recordarme
                </label>
              </div>
            </div>
          </div>
          @* Boton iniciar sesion *@
          <button type="button" class="btn btn-primary d-grid w-100" id="loginButton">
            Iniciar sesi칩n
          </button>

        </form>

      </div>
    </div>
  </div>
  <!-- /Login -->
</div>
</div>
